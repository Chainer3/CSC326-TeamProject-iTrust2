<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="cpt">

	<script th:src="@{/js/dateTimeService.js}"
		src="../js/dateTimeService.js"></script>

	<!-- main function that loads logView.html -->
	<div ng-app="cptsApp" ng-controller="cptsCtrl as ctrl">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<div class="panel panel-primary">

						<!-- active cpt's header -->
						<div class="panel-heading">
							<h3>Active CPT Codes</h3>
						</div>
						<div class="panel-body">
							<table class="table table-bordered" name="cpt_table">

								<!-- table column headers -->
								<thead>
									<tr>
										<th>CPT Code</th>
										<th>Time Range</th>
										<th>Price</th>
										<th>Action</th>
									</tr>
								</thead>

								<!-- CPT code for every row, ordered by code ascending -->
								<tbody>
									<tr name="cptTableRow" ng-repeat="l in ctrl.cpts">
										<td name="codeCell">{{l.code}}</td>
										<td name="descriptionCell">{{l.description}}</td>
										<td name="costCell">{{l.cost}}</td>
										<td name="actionCell"><button mat-raised-button color="blue";
										          ng-click="ctrl.prevPage()">Edit</button>
										         <button mat-raised-button color="red">Delete</button></td>								</tr>
								</tbody>
							</table>
							
							<br>
							<div class="row">
							   <div class="col-md-12">
							      <div class="panel panel-default">
							         <div class="panel-heading">Add New Code</div>
							         <div class="panel-body">
							            <form class="form-horizontal" role="form" name="viewLogForm"
												ng-submit="ctrl.searchByDate()">
												<br>
												
												<div class="row">

													<!-- start date -->
													<div class="col-md-5">
														<label>Code</label>
														<div class="row">
															<div class="col-md-7">
																<input type="date" class="form-control" name="startDate"
																	ng-model="ctrl.startDate" ng-max="ctrl.endDate"
																	required />
															</div>
														</div>
													</div>

													<!-- end date -->
													<div class="col-md-5">
														<label>Time Range</label>
														<div class="row">
															<div class="col-md-7">
																<input type="date" class="form-control" name="endDate"
																	ng-model="ctrl.endDate" required />
															</div>
														</div>
													</div>
													
													
													<div class="col-md-5">													<div class="col-md-5">
														<label>Price</label>
														<div class="row">
															<div class="col-md-7">
																<input type="date" class="form-control" name="endDate"
																	ng-model="ctrl.endDate" required />
															</div>
														</div>
													</div>
							                    </div>
							                    <br/>
							            </form>							            
							        </div> 
							    </div>
							</div>
							<br/>
						
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

    <script>
	var App = angular.module('cptsApp',[]);
	
	angular.module("cptsApp").controller('cptsCtrl', function($scope, $http) {
       var self = this;
       self.cpts = [];
       self.updateTable = function() {
          $http.get("/iTrust2/api/v1/cptcodes/").then(function(response) {
        	  self.cpts = response.data;
          });
       }
       
       self.updateTable();
    })
		
    </script>